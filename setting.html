<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="icon"
      type="image/png"
      href="/STATIC/Images/icons/trimly logo.svg"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Geist:wght@100..900&family=Sora:wght@100..800&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="./style.css" />
    <title>Settings</title>
  </head>
  <body>
    <div class="app-container">
      <div id="mobile-overlay"></div>

      <!-- SIDEBAR -->
      <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
          <div class="logo-area">
            <span class="logo-text">Trimly</span>
            <!-- note: there are two visual toggles (sidebar icon & hamburger), JS handles both -->
            <i class="nav-icon sidebar-toggle-icon">
              <img src="/STATIC/Images/icons/trimly logo.svg" alt="" />
            </i>
          </div>
        </div>

        <nav class="nav-list">
          <a href="Home.html" class="nav-item">
            <i class="nav-icon"
              ><img src="/STATIC/Images/icons/Vector.svg" alt=""
            /></i>
            <span class="nav-label">Home</span>
          </a>
          <a href="favourite.html" class="nav-item">
            <i class="nav-icon"
              ><img src="/STATIC/Images/icons/mynaui_heart.svg" alt=""
            /></i>
            <span class="nav-label">Favourite</span>
          </a>
          <a href="message.html" class="nav-item">
            <i class="nav-icon"
              ><img src="/STATIC/Images/icons/message.svg" alt=""
            /></i>
            <span class="nav-label">Messages</span>
          </a>
          <a href="booking.html" class="nav-item">
            <i class="nav-icon"
              ><img src="/STATIC/Images/icons/bookings.svg" alt=""
            /></i>
            <span class="nav-label">Bookings</span>
          </a>
          <a href="setting.html" class="nav-item active">
            <i class="nav-icon"
              ><img src="/STATIC/Images/icons/settings.svg" alt=""
            /></i>
            <span class="nav-label">Settings</span>
          </a>
        </nav>

        <div class="social-icons">
          <a href="#"
            ><i><img src="/STATIC/Images/fb.svg" alt="" /></i
          ></a>
          <a href="#"
            ><i><img src="/STATIC/Images/icons/ig.svg" alt="" /></i
          ></a>
          <a href="#"
            ><i><img src="/STATIC/Images/icons/x.svg" alt="" /></i
          ></a>
          <a href="#"
            ><i><img src="/STATIC/Images/icons/messenger.svg" alt="" /></i
          ></a>
        </div>
      </aside>

      <!-- HAMBURGER BUTTON -->
      <button
        id="hamburger-btn"
        class="hamburger-btn"
        aria-label="Toggle sidebar"
      >
        <img src="/STATIC/Images/icons/trimly logo.svg" alt="menu" />
      </button>

      <!-- MAIN -->
      <main class="main-content">
        <header class="top-bar">
          <div class="search-container">
            <i style="font-size: 18px; color: rgba(0, 0, 0, 1)"
              ><img src="/STATIC/Images/search.svg" alt=""
            /></i>
            <input
              type="text"
              id="searchInput"
              class="search-input"
              placeholder="Search"
              aria-label="Search barbers"
            />
          </div>

          <div class="notificationwithprofile">
            <div class="notifications">
              <img
                src="/STATIC/Images/icons/notificatiion.svg"
                alt="Notifications"
              />
              <span
                class="notification-badge"
                data-count="0"
                id="notificationCount"
                >0</span
              >
            </div>

            <div class="profile">
              <div class="avatar avatar-image">T</div>
            </div>
          </div>
        </header>

        <section class="settings-page">
          <!-- PROFILE -->
          <div class="settings-card">
            <h3>Profile</h3>

            <div class="profile-row">
              <div class="avatar avatar-image" id="settingsAvatar">T</div>
              <input type="file" id="avatarInput" accept="image/*" hidden />
              <button id="changeAvatarBtn" class="btn-secondary">
                Change Photo
              </button>
            </div>

            <input id="profileName" type="text" placeholder="Full Name" />
            <input id="profileEmail" type="email" placeholder="Email Address" />
            <input id="profilePhone" type="tel" placeholder="Phone Number" />
            <input id="profileLocation" type="text" placeholder="Location" />

            <button id="saveProfileBtn" class="btn-primary">
              Save Changes
            </button>
          </div>

          <!-- PASSWORD -->
          <div class="settings-card">
            <h3>Password</h3>

            <input
              id="currentPassword"
              type="password"
              placeholder="Current Password"
            />
            <input
              id="newPassword"
              type="password"
              placeholder="New Password"
            />
            <input
              id="confirmPassword"
              type="password"
              placeholder="Confirm New Password"
            />

            <button id="changePasswordBtn" class="btn-primary">
              Change Password
            </button>
          </div>

          <!-- PAYMENT HISTORY -->
          <div class="settings-card">
            <h3>Payment History</h3>

            <div class="payment-row">
              <div>
                <strong>â‚¦5,000</strong>
                <p>Ariyo Barbing Services</p>
                <small>12 Jun 2025</small>
              </div>

              <div class="payment-actions">
                <span class="status completed">Completed</span>
                <button class="link-btn view-receipt-btn">View Receipt</button>
              </div>
            </div>
          </div>

          <!-- NOTIFICATIONS -->
          <div class="settings-card">
            <h3>Notifications</h3>

            <label class="toggle">
              <input
                type="checkbox"
                class="notif-toggle"
                data-key="bookingConfirm"
                checked
              />
              <span>Booking confirmations</span>
            </label>

            <label class="toggle">
              <input
                type="checkbox"
                class="notif-toggle"
                data-key="bookingReminder"
              />

              <span>Booking reminders</span>
            </label>

            <label class="toggle">
              <input
                type="checkbox"
                class="notif-toggle"
                data-key="promotions"
              />

              <span>Promotions & offers</span>
            </label>
          </div>

          <!-- LOGOUT -->
          <div class="settings-card danger-zone">
            <button id="logoutBtn" class="btn-danger">Logout</button>
          </div>
        </section>
      </main>
    </div>

    <script>
      /* ----------------------------
                 DATA: barbers (with verified)
                 ---------------------------- */
      const barbers = {
        1: {
          id: "1",
          name: "Ariyo barbing services",
          img: "/STATIC/Images/e3e57f5dd5ab20b760d3f389da7910e955587728.jpg",
          location: "Lagos",
          rating: 4.8,
          amount: 5000,
          desc: "Premium Lagos barbershop known for sharp fades, afro grooming, and clean modern cuts.",
          verified: true,
          priceTier: "mid",
          availability: [17, 24, 19, 29, 27, 5, 1, 22, 6, 10],

          reviews: [
            {
              name: "David Adepoju",
              avatar: "/STATIC/Images/icons/Frame review.png",
              rating: 5,
              date: "June 10, 2025",
              text: "Amazing service! My fade came out clean and sharp. Easily one of the best barbers in Lagos.",
            },
            {
              name: "Michael Femi",
              avatar: "/STATIC/Images/icons/Frame review2.png",
              rating: 4,
              date: "June 5, 2025",
              text: "Good attention to detail. The shop was neat and he kept to time.",
            },
            {
              name: "Tunde Ilori",
              avatar: "/STATIC/Images/icons/Frame review3.png",
              rating: 5,
              date: "May 28, 2025",
              text: "Best haircut I've had in months. Highly recommended.",
            },
          ],

          workingHours: [{ start: "07:00", end: "22:00" }],
        },

        2: {
          id: "2",
          name: "Fola barbing services",
          img: "/STATIC/Images/51dff4b5b6c4b24a89fc357e76ddb4bffa5f60cb.jpg",
          location: "Abuja",
          rating: 3.0,
          amount: 2500,
          desc: "Affordable neighborhood barbershop offering simple, clean haircuts at great value.",
          verified: false,
          priceTier: "low",
          availability: [16, 1, 3, 23, 7, 22, 19, 26, 25, 11],

          reviews: [
            {
              name: "Chibuzo Kingsley",
              avatar: "/STATIC/Images/icons/Frame review.png",
              rating: 3,
              date: "May 12, 2025",
              text: "Decent cut. Could improve timing but overall fair.",
            },
            {
              name: "Aisha Bello",
              avatar: "/STATIC/Images/icons/Frame review2.png",
              rating: 4,
              date: "May 1, 2025",
              text: "Pleasant service, friendly barber. Good pricing.",
            },
            {
              name: "Yusuf Ahmed",
              avatar: "/STATIC/Images/icons/Frame review3.png",
              rating: 2,
              date: "April 20, 2025",
              text: "Cut was okay but not exactly what I asked for.",
            },
          ],

          workingHours: [{ start: "07:00", end: "22:00" }],
        },

        3: {
          id: "3",
          name: "Adebisi barbing services",
          img: "/STATIC/Images/fd5eaeb566eaee245f79cac02879dbca4d66fb74.jpg",
          location: "Ibadan",
          rating: 4.2,
          amount: 4000,
          desc: "Professional Ibadan barber specializing in detailed fades, beard trims, and styling.",
          verified: true,
          priceTier: "mid",
          availability: [16, 13, 20, 24, 6, 8, 21, 25, 17, 3],
          reviews: [
            {
              name: "Kunle Owolabi",
              avatar: "/STATIC/Images/icons/Frame review.png",
              rating: 4,
              date: "June 2, 2025",
              text: "Very professional. My beard trim came out sharp.",
            },
            {
              name: "Samuel Peters",
              avatar: "/STATIC/Images/icons/Frame review2.png",
              rating: 5,
              date: "May 27, 2025",
              text: "Excellent work. Definitely coming back.",
            },
            {
              name: "Ireti A.",
              avatar: "/STATIC/Images/icons/Frame review3.png",
              rating: 4,
              date: "May 10, 2025",
              text: "Neat shop and good vibes. Loved the haircut.",
            },
          ],

          workingHours: [{ start: "07:00", end: "22:00" }],
        },

        4: {
          id: "4",
          name: "African barbing services",
          img: "/STATIC/Images/71954b1bf5bf641a949aa7d9565112e807cd9a25.jpg",
          location: "Ibadan",
          rating: 4.0,
          amount: 6500,
          desc: "Luxury grooming experience with premium tools, skilled barbers, and stylish ambience.",
          verified: false,
          priceTier: "high",
          availability: [10, 12, 14, 16, 4, 13, 22, 15, 9, 1],

          reviews: [
            {
              name: "Precious Daniel",
              avatar: "/STATIC/Images/icons/Frame review.png",
              rating: 4,
              date: "June 9, 2025",
              text: "Good service but a little pricey.",
            },
            {
              name: "Emeka U.",
              avatar: "/STATIC/Images/icons/Frame review2.png",
              rating: 5,
              date: "June 1, 2025",
              text: "Great haircut, worth the money.",
            },
            {
              name: "Ola N.",
              avatar: "/STATIC/Images/icons/Frame review3.png",
              rating: 3,
              date: "May 19, 2025",
              text: "Decent but expected a bit more for the price.",
            },
          ],
          workingHours: [{ start: "07:00", end: "22:00" }],
        },

        5: {
          id: "5",
          name: "Ayodele barbing services",
          img: "/STATIC/Images/89f0e267a3761a55a184609ef53967fc6beed6e6.jpg",
          location: "Abuja",
          rating: 3.5,
          amount: 3000,
          desc: "Quick and reliable barber service ideal for regular maintenance cuts and trims.",
          verified: false,
          priceTier: "low",
          availability: [8, 21, 16, 7, 28, 30, 1, 6, 24, 13],

          reviews: [
            {
              name: "Henry Okafor",
              avatar: "/STATIC/Images/icons/Frame review.png",
              rating: 4,
              date: "June 3, 2025",
              text: "Affordable and clean cut. Good value.",
            },
            {
              name: "Sade Ojo",
              avatar: "/STATIC/Images/icons/Frame review2.png",
              rating: 3,
              date: "May 25, 2025",
              text: "Okay haircut, nothing extraordinary.",
            },
            {
              name: "Daniel O.",
              avatar: "/STATIC/Images/icons/Frame review3.png",
              rating: 5,
              date: "May 14, 2025",
              text: "Excellent job. Will be returning.",
            },
          ],
          workingHours: [{ start: "07:00", end: "22:00" }],
        },

        6: {
          id: "6",
          name: "Rise barbing services",
          img: "/STATIC/Images/7e4c3695e25ee081e122f0dac2c4f7c7b0c3ccce.jpg",
          location: "Lagos",
          rating: 4.8,
          amount: 8000,
          desc: "High-end barbershop delivering premium fades, luxury grooming, and elite service.",
          verified: true,
          priceTier: "high",
          availability: [21, 13, 11, 28, 22, 10, 5, 2, 18, 7],

          reviews: [
            {
              name: "Favour Chinedu",
              avatar: "/STATIC/Images/icons/Frame review.png",
              rating: 5,
              date: "June 8, 2025",
              text: "Top-notch! The fade was perfect and the service was premium.",
            },
            {
              name: "Olawale Ade",
              avatar: "/STATIC/Images/icons/Frame review2.png",
              rating: 4,
              date: "June 4, 2025",
              text: "Loved the experience, great ambience.",
            },
            {
              name: "Kelvin U.",
              avatar: "/STATIC/Images/icons/Frame review3.png",
              rating: 5,
              date: "May 29, 2025",
              text: "Perfect haircut every time. Highly skilled barber.",
            },
          ],

          workingHours: [{ start: "07:00", end: "22:00" }],
        },
      };

      /* ----------------------------
                 SIDEBAR: toggle & overlay logic
                 ---------------------------- */
      const sidebar = document.getElementById("sidebar");
      const hamburgerBtn = document.getElementById("hamburger-btn");
      const overlay = document.getElementById("mobile-overlay");
      // multiple toggle icons might exist
      function getSidebarToggleElements() {
        const arr = Array.from(
          document.querySelectorAll(".sidebar-toggle-icon")
        );
        // also include hamburger icon if it should toggle collapsed state on desktop
        return arr;
      }

      function toggleSidebar() {
        const isMobile = window.innerWidth <= 1024;
        if (isMobile) {
          sidebar.classList.toggle("mobile-open");
          if (sidebar.classList.contains("mobile-open")) {
            overlay.style.display = "block";
            setTimeout(() => (overlay.style.opacity = "1"), 10);
          } else {
            overlay.style.opacity = "0";
            setTimeout(() => (overlay.style.display = "none"), 300);
          }
        } else {
          sidebar.classList.toggle("collapsed");
        }
      }

      // Attach toggle listeners
      getSidebarToggleElements().forEach((el) =>
        el.addEventListener("click", toggleSidebar)
      );
      hamburgerBtn.addEventListener("click", () => {
        hamburgerBtn.classList.toggle("active");
        toggleSidebar();
      });

      overlay.addEventListener("click", () => {
        sidebar.classList.remove("mobile-open");
        overlay.style.opacity = "0";
        setTimeout(() => (overlay.style.display = "none"), 300);
      });

      window.addEventListener("resize", () => {
        if (window.innerWidth > 768) {
          sidebar.classList.remove("mobile-open");
          overlay.style.display = "none";
          overlay.style.opacity = "0";
        }
      });

      document
        .getElementById("saveProfileBtn")
        .addEventListener("click", () => {
          const profile = {
            name: profileName.value,
            email: profileEmail.value,
            phone: profilePhone.value,
            location: profileLocation.value,
          };

          localStorage.setItem("trimly_profile", JSON.stringify(profile));
          alert("Profile updated successfully");
        });

      document
        .getElementById("changePasswordBtn")
        .addEventListener("click", () => {
          if (newPassword.value !== confirmPassword.value) {
            alert("Passwords do not match");
            return;
          }

          alert("Password changed successfully");
        });

      document.querySelectorAll(".view-receipt-btn").forEach((btn) => {
        btn.addEventListener("click", () => {
          // Mock receipt data
          window.activeReceipt = {
            invoiceNo: "TRIM-1023",
            reference: "TRIM-REF-9981",
            barber: "Ariyo Barbing Services",
            date: "12 Jun 2025",
            time: "2:30 PM",
            amount: 5000,
            paidAt: Date.now(),
          };

          // Open your receipt modal here
          alert("Receipt opened");
        });
      });

      document.querySelectorAll(".notif-toggle").forEach((toggle) => {
        toggle.addEventListener("change", () => {
          const settings =
            JSON.parse(localStorage.getItem("trimly_notifications")) || {};

          settings[toggle.dataset.key] = toggle.checked;

          localStorage.setItem(
            "trimly_notifications",
            JSON.stringify(settings)
          );
        });
      });

      document.getElementById("logoutBtn").addEventListener("click", () => {
        if (!confirm("Are you sure you want to logout?")) return;

        localStorage.clear();
        window.location.href = "\login_customer.html";
      });

      // functionality to change profile photo
      const avatarInput = document.getElementById("avatarInput");
      const changeAvatarBtn = document.getElementById("changeAvatarBtn");

      // Open file picker
      changeAvatarBtn.addEventListener("click", () => {
        avatarInput.click();
      });

      // Handle image selection
      avatarInput.addEventListener("change", () => {
        const file = avatarInput.files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = () => {
          // Save avatar globally
          localStorage.setItem("trimly_avatar", reader.result);

          // Update avatars immediately
          updateAllAvatars();
        };
        reader.readAsDataURL(file);
      });

      function updateAllAvatars() {
        const avatar = localStorage.getItem("trimly_avatar");
        if (!avatar) return;

        document.querySelectorAll(".avatar").forEach((el) => {
          el.style.backgroundImage = `url(${avatar})`;
          el.style.backgroundSize = "cover";
          el.style.backgroundPosition = "center";
          el.textContent = ""; // remove initials
        });
      }

      document.addEventListener("DOMContentLoaded", () => {
        updateAllAvatars();
      });

      document.addEventListener("DOMContentLoaded", () => {
        // Initialize notification system
        initTrimlyNotifications();
      });
    </script>
    <script src="./TrimlyNotifications.js"></script>
  </body>
</html>
