<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Trimly | Bookings</title>
    <link
      rel="icon"
      type="image/png"
      href="/STATIC/Images/icons/trimly logo.svg"
    />
    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Plus+Jakarta+Sans:wght@500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        --font-family: "Geist", -apple-system, BlinkMacSystemFont, sans-serif;
        --color-bg-sidebar: #f9fafb;
        --color-bg-main: #ffffff;
        --color-text-primary: #000000;
        --color-text-secondary: #6b7280;
        --color-accent: rgba(218, 228, 243, 1);
        --color-border: #e5e7eb;
        --color-hover: rgba(240, 240, 240, 1);
        --sidebar-width-expanded: 250px;
        --sidebar-width-collapsed: 80px;
        --header-height: 80px;
        --transition-speed: 0.3s;

        /* Booking Colors */
        --primary: #111827;
        --secondary: #3b82f6;
        --secondary-light: #60a5fa;
        --success: #10b981;
        --warning: #f59e0b;
        --error: #ef4444;
        --info: #3b82f6;
        --white: #ffffff;
        --off-white: #f9fafb;
        --light-gray: #f3f4f6;
        --gray: #9ca3af;
        --dark-gray: #6b7280;
        --black: #111827;
        --radius: 10px;
        --radius-lg: 14px;
        --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1),
          0 2px 4px -1px rgba(0, 0, 0, 0.06);
        --shadow-lg: 0 20px 25px -5px rgba(0, 0, 0, 0.1),
          0 10px 10px -5px rgba(0, 0, 0, 0.04);
      }

      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      body {
        font-family: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI",
          Roboto, Oxygen, Ubuntu, sans-serif;
        background: var(--off-white);
        color: var(--black);
        min-height: 100vh;
        line-height: 1.5;
        overflow-x: hidden;
      }

      /* App Container */
      .app-container {
        display: flex;
        height: 100vh;
        width: 100%;
      }

      /* Sidebar (same as other pages) */
      .sidebar {
        width: var(--sidebar-width-expanded);
        background-color: var(--color-bg-sidebar);
        border-right: 1px solid var(--color-border);
        display: flex;
        flex-direction: column;
        transition: all var(--transition-speed);
        flex-shrink: 0;
        overflow-x: hidden;
        height: 100vh;
        position: relative;
        z-index: 1000;
      }

      .sidebar.collapsed {
        width: var(--sidebar-width-collapsed);
      }

      .sidebar.collapsed .logo-text,
      .sidebar.collapsed .nav-label,
      .sidebar.collapsed .social-icons {
        opacity: 0;
        pointer-events: none;
      }

      .sidebar.collapsed .logo-area {
        justify-content: center;
        padding: 20px 0;
      }

      .sidebar.collapsed .logo-text {
        display: none;
      }

      .sidebar.collapsed .sidebar-toggle-icon {
        display: flex !important;
        justify-content: center !important;
        width: 100% !important;
      }

      .sidebar.collapsed .sidebar-toggle-icon img {
        width: 36px !important;
        height: 36px !important;
        opacity: 1 !important;
        visibility: visible !important;
      }

      .sidebar-header {
        height: var(--header-height);
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0 24px;
      }

      .logo-area {
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .logo-text {
        font-size: 20px;
        font-weight: 700;
      }

      .nav-list {
        flex: 1;
        padding: 16px 12px;
        display: flex;
        flex-direction: column;
        gap: 4px;
      }

      .nav-item {
        display: flex;
        align-items: center;
        padding: 12px 16px;
        border-radius: 8px;
        color: var(--color-text-secondary);
        transition: all 0.2s;
        gap: 12px;
        text-decoration: none;
      }

      .nav-item:hover {
        background-color: var(--color-hover);
        color: var(--color-text-primary);
      }

      .nav-item.active {
        background-color: var(--color-accent);
        color: var(--color-text-primary);
        font-weight: 500;
      }

      .nav-icon img {
        width: 18px;
        height: 18px;
      }

      .social-icons {
        padding: 24px;
        display: flex;
        justify-content: space-between;
        gap: 20px;
      }

      /* Mobile Overlay */
      #mobile-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: rgba(0, 0, 0, 0.5);
        z-index: 40;
        display: none;
        opacity: 0;
        transition: opacity 0.3s ease;
      }

      /* Hamburger Button */
      .hamburger-btn {
        position: fixed;
        top: 20px;
        left: 20px;
        z-index: 1002;
        width: 44px;
        height: 44px;
        border-radius: 12px;
        display: none;
        align-items: center;
        justify-content: center;
        border: none;
        cursor: pointer;
        background: var(--white);
        box-shadow: var(--shadow);
        transition: all 0.3s ease;
      }

      .hamburger-btn img {
        width: 24px;
        height: 24px;
      }

      /* Main Content */
      .main-content {
        flex: 1;
        display: flex;
        flex-direction: column;
        overflow: hidden;
        background-color: var(--white);
        width: calc(100% - var(--sidebar-width-expanded));
        height: 100vh;
        transition: margin-left var(--transition-speed);
      }

      .sidebar.collapsed ~ .main-content {
        margin-left: var(--sidebar-width-collapsed);
        width: calc(100% - var(--sidebar-width-collapsed));
      }

      /* Header */
      .header {
        height: 70px;
        background: var(--white);
        border-bottom: 1px solid var(--light-gray);
        padding: 0 32px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        position: sticky;
        top: 0;
        z-index: 900;
      }

      .header-left {
        display: flex;
        flex-direction: column;
        gap: 4px;
      }

      .page-title {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--black);
      }

      .breadcrumb {
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 0.85rem;
        color: var(--gray);
      }

      .breadcrumb .active {
        color: var(--black);
        font-weight: 500;
      }

      .header-right {
        display: flex;
        align-items: center;
        gap: 20px;
      }

      .header-actions {
        display: flex;
        gap: 12px;
      }

      .header-action-btn {
        position: relative;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        border: 1px solid var(--light-gray);
        background: var(--white);
        color: var(--dark-gray);
        cursor: pointer;
        transition: all 0.25s ease;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .notification-badge {
        position: absolute;
        top: -4px;
        right: -4px;
        background: var(--error);
        color: var(--white);
        font-size: 0.7rem;
        font-weight: 600;
        width: 18px;
        height: 18px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .date-display {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 8px 16px;
        background: var(--light-gray);
        border-radius: var(--radius);
        font-size: 0.9rem;
        color: var(--dark-gray);
        font-weight: 500;
      }

      /* Bookings Container */
      .bookings-container {
        padding: 32px;
        overflow-y: auto;
        height: calc(100vh - 70px);
      }

      /* Bookings Header */
      .bookings-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 32px;
        flex-wrap: wrap;
        gap: 20px;
      }

      .bookings-header h1 {
        font-size: 1.8rem;
        font-weight: 700;
      }

      /* Bookings Filters */
      .bookings-filters {
        display: flex;
        gap: 16px;
        flex-wrap: wrap;
        margin-bottom: 32px;
        padding: 20px;
        background: var(--white);
        border-radius: var(--radius-lg);
        box-shadow: var(--shadow);
      }

      .filter-group {
        display: flex;
        flex-direction: column;
        gap: 8px;
      }

      .filter-group label {
        font-size: 0.9rem;
        font-weight: 600;
        color: var(--dark-gray);
      }

      .filter-select {
        padding: 10px 16px;
        border: 1px solid var(--light-gray);
        border-radius: var(--radius);
        background: var(--white);
        color: var(--black);
        font-size: 0.95rem;
        cursor: pointer;
        min-width: 150px;
      }

      .filter-select:focus {
        outline: none;
        border-color: var(--secondary);
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
      }

      /* Bookings Tabs */
      .bookings-tabs {
        display: flex;
        gap: 8px;
        border-bottom: 2px solid var(--light-gray);
        margin-bottom: 32px;
        overflow-x: auto;
      }

      .booking-tab {
        padding: 12px 24px;
        border: none;
        background: none;
        font-size: 1rem;
        font-weight: 600;
        color: var(--gray);
        cursor: pointer;
        white-space: nowrap;
        position: relative;
        transition: all 0.2s;
      }

      .booking-tab:hover {
        color: var(--black);
      }

      .booking-tab.active {
        color: var(--secondary);
      }

      .booking-tab.active::after {
        content: "";
        position: absolute;
        bottom: -2px;
        left: 0;
        right: 0;
        height: 2px;
        background: var(--secondary);
      }

      /* Bookings Stats */
      .bookings-stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-bottom: 32px;
      }

      .booking-stat-card {
        background: var(--white);
        border-radius: var(--radius-lg);
        padding: 24px;
        display: flex;
        align-items: center;
        gap: 20px;
        box-shadow: var(--shadow);
        transition: all 0.25s ease;
        border: 1px solid var(--light-gray);
      }

      .booking-stat-card:hover {
        transform: translateY(-5px);
        box-shadow: var(--shadow-lg);
      }

      .booking-stat-icon {
        width: 56px;
        height: 56px;
        border-radius: var(--radius);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        color: var(--white);
      }

      .booking-stat-info h3 {
        font-size: 1.8rem;
        margin-bottom: 4px;
        color: var(--black);
      }

      .booking-stat-info p {
        color: var(--dark-gray);
        font-size: 0.9rem;
      }

      /* Bookings Table */
      .bookings-table-container {
        background: var(--white);
        border-radius: var(--radius-lg);
        box-shadow: var(--shadow);
        overflow: hidden;
        margin-bottom: 32px;
      }

      .bookings-table-header {
        padding: 20px 24px;
        border-bottom: 1px solid var(--light-gray);
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .bookings-table-header h3 {
        font-size: 1.2rem;
        font-weight: 600;
      }

      .bookings-table-actions {
        display: flex;
        gap: 12px;
      }

      .bookings-table {
        width: 100%;
        border-collapse: collapse;
      }

      .bookings-table th {
        text-align: left;
        padding: 16px 24px;
        background: var(--off-white);
        border-bottom: 1px solid var(--light-gray);
        font-weight: 600;
        color: var(--dark-gray);
        font-size: 0.9rem;
      }

      .bookings-table td {
        padding: 20px 24px;
        border-bottom: 1px solid var(--light-gray);
        vertical-align: middle;
      }

      .booking-row {
        transition: all 0.2s;
        cursor: pointer;
      }

      .booking-row:hover {
        background: var(--off-white);
      }

      .booking-client {
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .booking-avatar {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: 600;
        font-size: 0.9rem;
      }

      .booking-client-info h4 {
        font-size: 1rem;
        margin-bottom: 4px;
      }

      .booking-client-info p {
        font-size: 0.85rem;
        color: var(--gray);
      }

      .booking-service {
        font-weight: 500;
      }

      .booking-date-time {
        display: flex;
        flex-direction: column;
        gap: 4px;
      }

      .booking-date {
        font-weight: 500;
      }

      .booking-time {
        font-size: 0.85rem;
        color: var(--gray);
      }

      .booking-price {
        font-weight: 700;
        color: var(--black);
      }

      .booking-status {
        padding: 6px 12px;
        border-radius: 20px;
        font-size: 0.85rem;
        font-weight: 600;
        display: inline-block;
        text-align: center;
        min-width: 80px;
      }

      .status-confirmed {
        background: #d1fae5;
        color: var(--success);
      }

      .status-pending {
        background: #fef3c7;
        color: var(--warning);
      }

      .status-cancelled {
        background: #fee2e2;
        color: var(--error);
      }

      .status-completed {
        background: #dbeafe;
        color: var(--secondary);
      }

      .booking-actions {
        display: flex;
        gap: 8px;
      }

      /* Empty State */
      .empty-state {
        text-align: center;
        padding: 60px 20px;
        color: var(--gray);
      }

      .empty-state i {
        font-size: 3rem;
        margin-bottom: 16px;
        color: var(--light-gray);
      }

      .empty-state h3 {
        font-size: 1.3rem;
        margin-bottom: 8px;
        color: var(--dark-gray);
      }

      .empty-state p {
        margin-bottom: 20px;
      }

      /* Buttons */
      .btn {
        padding: 10px 20px;
        border-radius: var(--radius);
        border: none;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.25s ease;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        font-size: 0.95rem;
      }

      .btn-sm {
        padding: 6px 12px;
        font-size: 0.85rem;
      }

      .btn-primary {
        background: linear-gradient(
          135deg,
          var(--secondary) 0%,
          var(--secondary-light) 100%
        );
        color: var(--white);
        border: none;
      }

      .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow);
      }

      .btn-secondary {
        background: var(--white);
        color: var(--dark-gray);
        border: 1px solid var(--light-gray);
      }

      .btn-secondary:hover {
        background: var(--light-gray);
      }

      .btn-success {
        background: var(--success);
        color: var(--white);
        border: none;
      }

      .btn-warning {
        background: var(--warning);
        color: var(--white);
        border: none;
      }

      .btn-danger {
        background: var(--error);
        color: var(--white);
        border: none;
      }

      .btn-icon {
        width: 36px;
        height: 36px;
        border-radius: 50%;
        border: 1px solid var(--light-gray);
        background: var(--white);
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.25s ease;
      }

      .btn-icon:hover {
        background: var(--light-gray);
      }

      /* Calendar View */
      .calendar-view {
        background: var(--white);
        border-radius: var(--radius-lg);
        box-shadow: var(--shadow);
        padding: 24px;
        margin-bottom: 32px;
      }

      .calendar-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 24px;
      }

      .calendar-nav {
        display: flex;
        align-items: center;
        gap: 16px;
      }

      .calendar-month {
        font-size: 1.3rem;
        font-weight: 600;
        color: var(--black);
      }

      .calendar-weekdays {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        text-align: center;
        font-weight: 600;
        color: var(--dark-gray);
        margin-bottom: 12px;
        padding-bottom: 12px;
        border-bottom: 1px solid var(--light-gray);
      }

      .calendar-days {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        gap: 8px;
      }

      .calendar-day {
        aspect-ratio: 1;
        padding: 8px;
        border-radius: var(--radius);
        border: 1px solid var(--light-gray);
        position: relative;
        cursor: pointer;
        transition: all 0.2s;
      }

      .calendar-day:hover {
        background: var(--off-white);
      }

      .calendar-day.today {
        background: var(--secondary);
        color: var(--white);
        border-color: var(--secondary);
      }

      .calendar-day.other-month {
        color: var(--gray);
        background: var(--off-white);
        opacity: 0.5;
      }

      .day-number {
        font-weight: 600;
        margin-bottom: 4px;
      }

      .day-bookings {
        display: flex;
        flex-direction: column;
        gap: 4px;
      }

      .day-booking {
        font-size: 0.75rem;
        padding: 2px 6px;
        border-radius: 4px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .booking-confirmed {
        background: #d1fae5;
        color: var(--success);
      }

      .booking-pending {
        background: #fef3c7;
        color: var(--warning);
      }

      /* Modal Styles */
      .modal {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.5);
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 1100;
        padding: 20px;
      }

      .modal-content {
        background: var(--white);
        border-radius: var(--radius-lg);
        width: 100%;
        max-width: 600px;
        max-height: 90vh;
        overflow-y: auto;
        box-shadow: var(--shadow-lg);
      }

      .modal-header {
        padding: 20px 24px;
        border-bottom: 1px solid var(--light-gray);
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .modal-header h3 {
        font-size: 1.3rem;
        font-weight: 600;
        color: var(--black);
      }

      .modal-body {
        padding: 24px;
      }

      .modal-footer {
        padding: 20px 24px;
        border-top: 1px solid var(--light-gray);
        display: flex;
        justify-content: flex-end;
        gap: 12px;
      }

      /* Form Styles */
      .form-group {
        margin-bottom: 20px;
      }

      .form-group label {
        display: block;
        margin-bottom: 8px;
        font-weight: 600;
        color: var(--dark-gray);
      }

      .form-control {
        width: 100%;
        padding: 12px 16px;
        border: 1px solid var(--light-gray);
        border-radius: var(--radius);
        font-size: 1rem;
        font-family: inherit;
        transition: all 0.2s;
      }

      .form-control:focus {
        outline: none;
        border-color: var(--secondary);
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
      }

      .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
      }

      /* Toast Notification */
      .toast {
        position: fixed;
        bottom: 32px;
        right: 32px;
        padding: 16px 24px;
        border-radius: var(--radius);
        color: var(--white);
        font-weight: 500;
        box-shadow: var(--shadow-lg);
        z-index: 1200;
        transform: translateY(100px);
        opacity: 0;
        transition: all 0.3s ease;
        max-width: 350px;
      }

      .toast.show {
        transform: translateY(0);
        opacity: 1;
      }

      .toast.success {
        background: var(--success);
      }

      .toast.error {
        background: var(--error);
      }

      .toast.warning {
        background: var(--warning);
      }

      .toast.info {
        background: var(--info);
      }

      /* Responsive Design */
      @media (max-width: 1024px) {
        .sidebar {
          position: fixed;
          left: 0;
          top: 0;
          transform: translateX(-100%);
          z-index: 1000;
        }

        .sidebar.mobile-open {
          transform: translateX(0);
        }

        .main-content {
          margin-left: 0 !important;
          width: 100% !important;
        }

        .hamburger-btn {
          display: flex;
        }

        .bookings-table {
          display: block;
          overflow-x: auto;
        }

        .calendar-days {
          gap: 4px;
        }

        .day-booking {
          font-size: 0.7rem;
          padding: 1px 4px;
        }
      }

      @media (max-width: 768px) {
        .bookings-container {
          padding: 16px;
        }

        .header {
          padding: 0 16px;
          flex-direction: column;
          gap: 16px;
          height: auto;
          padding: 16px;
        }

        .header-right {
          flex-wrap: wrap;
          justify-content: center;
          gap: 12px;
        }

        .bookings-header {
          flex-direction: column;
          align-items: flex-start;
          gap: 16px;
        }

        .bookings-filters {
          flex-direction: column;
          gap: 16px;
        }

        .filter-select {
          width: 100%;
        }

        .bookings-stats {
          grid-template-columns: 1fr;
        }

        .bookings-table-header {
          flex-direction: column;
          gap: 16px;
          align-items: flex-start;
        }

        .bookings-table-actions {
          width: 100%;
          justify-content: space-between;
        }

        .form-row {
          grid-template-columns: 1fr;
          gap: 16px;
        }

        .modal-content {
          width: 95%;
          margin: 10px;
        }

        .modal-footer {
          flex-direction: column;
        }

        .modal-footer .btn {
          width: 100%;
        }

        .booking-actions {
          flex-direction: column;
          gap: 4px;
        }
      }

      @media (max-width: 480px) {
        .bookings-tabs {
          flex-wrap: wrap;
        }

        .booking-tab {
          padding: 8px 16px;
          font-size: 0.9rem;
        }

        .booking-client {
          flex-direction: column;
          align-items: flex-start;
          gap: 8px;
        }

        .booking-status {
          min-width: 60px;
          padding: 4px 8px;
          font-size: 0.8rem;
        }
      }

      /* Quick fix to make hamburger match logo size */
      .hamburger-btn img {
        width: 18px !important;
        height: 18px !important;
      }

      /* Ensure sidebar logo is same size */
      .logo-area img,
      .sidebar-toggle-icon img {
        width: 18px;
        height: 18px;
      }

      /* Override any other conflicting styles */
      .sidebar.collapsed .sidebar-toggle-icon img {
        width: 18px !important;
        height: 18px !important;
      }
    </style>
  </head>
  <body>
    <div class="app-container">
      <!-- Sidebar -->
      <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
          <div class="logo-area">
            <span class="logo-text">Trimly</span>
            <i class="nav-icon sidebar-toggle-icon">
              <img src="/STATIC/Images/icons/trimly logo.svg" alt="" />
            </i>
          </div>
        </div>

        <nav class="nav-list">
          <a href="dashboard_barber.html" class="nav-item">
            <i class="nav-icon"
              ><img src="/STATIC/Images/icons/Vector.svg" alt=""
            /></i>
            <span class="nav-label">Dashboard</span>
          </a>
          <a href="messages_barber.html" class="nav-item">
            <i class="nav-icon"
              ><img src="/STATIC/Images/icons/message.svg" alt=""
            /></i>
            <span class="nav-label">Messages</span>
          </a>
          <a href="booking_barber.html" class="nav-item active">
            <i class="nav-icon"
              ><img src="/STATIC/Images/icons/bookings.svg" alt=""
            /></i>
            <span class="nav-label">Bookings</span>
          </a>
          <a href="Settings_barber.html" class="nav-item">
            <i class="nav-icon"
              ><img src="/STATIC/Images/icons/settings.svg" alt=""
            /></i>
            <span class="nav-label">Settings</span>
          </a>
        </nav>

        <div class="social-icons">
          <a href="#"
            ><i><img src="/STATIC/Images/fb.svg" alt="" /></i
          ></a>
          <a href="#"
            ><i><img src="/STATIC/Images/icons/ig.svg" alt="" /></i
          ></a>
          <a href="#"
            ><i><img src="/STATIC/Images/icons/x.svg" alt="" /></i
          ></a>
          <a href="#"
            ><i><img src="/STATIC/Images/icons/messenger.svg" alt="" /></i
          ></a>
        </div>
      </aside>

      <!-- Hamburger Button -->
      <button
        id="hamburger-btn"
        class="hamburger-btn"
        aria-label="Toggle sidebar"
      >
        <img src="/STATIC/Images/icons/trimly logo.svg" alt="menu" />
      </button>

      <!-- Mobile Overlay -->
      <div id="mobile-overlay"></div>

      <!-- Main Content -->
      <div class="main-content">
        <!-- Header -->
        <header class="header">
          <div class="header-left">
            <h1 class="page-title">Bookings</h1>
            <div class="breadcrumb">
              <span>Home</span>
              <i class="fas fa-chevron-right"></i>
              <span class="active">Bookings</span>
            </div>
          </div>

          <div class="header-right">
            <div class="header-actions">
              <button class="header-action-btn" id="notificationsBtn">
                <i class="fas fa-bell"></i>
                <span class="notification-badge" id="notificationCount">3</span>
              </button>
              <button
                class="header-action-btn"
                onclick="location.href='messages_barber.html'"
                id="messagesBtn"
              >
                <i class="fas fa-envelope"></i>
                <span class="notification-badge">5</span>
              </button>
            </div>

            <div class="date-display">
              <i class="fas fa-calendar-day"></i>
              <span id="todayDate"></span>
            </div>
          </div>
        </header>

        <!-- Bookings Content -->
        <div class="bookings-container">
          <!-- Bookings Header -->
          <div class="bookings-header">
            <h1>Manage Bookings</h1>
            <button class="btn btn-primary" onclick="openNewBookingModal()">
              <i class="fas fa-plus-circle"></i> New Booking
            </button>
          </div>

          <!-- Bookings Stats -->
          <div class="bookings-stats">
            <div class="booking-stat-card">
              <div
                class="booking-stat-icon"
                style="
                  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                "
              >
                <i class="fas fa-calendar-check"></i>
              </div>
              <div class="booking-stat-info">
                <h3 id="totalBookings">0</h3>
                <p>Total Bookings</p>
              </div>
            </div>
            <div class="booking-stat-card">
              <div
                class="booking-stat-icon"
                style="
                  background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
                "
              >
                <i class="fas fa-clock"></i>
              </div>
              <div class="booking-stat-info">
                <h3 id="todayBookings">0</h3>
                <p>Today's Bookings</p>
              </div>
            </div>
            <div class="booking-stat-card">
              <div
                class="booking-stat-icon"
                style="
                  background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
                "
              >
                <i class="fas fa-money-bill-wave"></i>
              </div>
              <div class="booking-stat-info">
                <h3>₦<span id="totalRevenue">0</span></h3>
                <p>Total Revenue</p>
              </div>
            </div>
            <div class="booking-stat-card">
              <div
                class="booking-stat-icon"
                style="
                  background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
                "
              >
                <i class="fas fa-check-circle"></i>
              </div>
              <div class="booking-stat-info">
                <h3 id="confirmedBookings">0</h3>
                <p>Confirmed</p>
              </div>
            </div>
          </div>

          <!-- Bookings Tabs -->
          <div class="bookings-tabs">
            <button class="booking-tab active" data-tab="all">
              All Bookings
            </button>
            <button class="booking-tab" data-tab="today">Today</button>
            <button class="booking-tab" data-tab="upcoming">Upcoming</button>
            <button class="booking-tab" data-tab="pending">Pending</button>
            <button class="booking-tab" data-tab="confirmed">Confirmed</button>
            <button class="booking-tab" data-tab="completed">Completed</button>
            <button class="booking-tab" data-tab="cancelled">Cancelled</button>
          </div>

          <!-- Bookings Filters -->
          <div class="bookings-filters">
            <div class="filter-group">
              <label for="dateFilter">Date</label>
              <select id="dateFilter" class="filter-select">
                <option value="all">All Dates</option>
                <option value="today">Today</option>
                <option value="week">This Week</option>
                <option value="month">This Month</option>
                <option value="custom">Custom Range</option>
              </select>
            </div>
            <div class="filter-group">
              <label for="serviceFilter">Service</label>
              <select id="serviceFilter" class="filter-select">
                <option value="all">All Services</option>
                <!-- Services will be populated -->
              </select>
            </div>
            <div class="filter-group">
              <label for="statusFilter">Status</label>
              <select id="statusFilter" class="filter-select">
                <option value="all">All Status</option>
                <option value="pending">Pending</option>
                <option value="confirmed">Confirmed</option>
                <option value="completed">Completed</option>
                <option value="cancelled">Cancelled</option>
              </select>
            </div>
            <div class="filter-group">
              <label for="sortFilter">Sort By</label>
              <select id="sortFilter" class="filter-select">
                <option value="date-desc">Date (Newest First)</option>
                <option value="date-asc">Date (Oldest First)</option>
                <option value="price-desc">Price (High to Low)</option>
                <option value="price-asc">Price (Low to High)</option>
              </select>
            </div>
            <div class="filter-group" style="align-self: flex-end">
              <button class="btn btn-secondary" onclick="clearFilters()">
                <i class="fas fa-times"></i> Clear
              </button>
            </div>
          </div>

          <!-- Calendar View -->
          <div class="calendar-view" id="calendarView">
            <div class="calendar-header">
              <h3 class="calendar-month" id="calendarMonth">Month Year</h3>
              <div class="calendar-nav">
                <button class="btn-icon" id="prevMonth">
                  <i class="fas fa-chevron-left"></i>
                </button>
                <button class="btn btn-secondary btn-sm" onclick="goToToday()">
                  Today
                </button>
                <button class="btn-icon" id="nextMonth">
                  <i class="fas fa-chevron-right"></i>
                </button>
              </div>
            </div>
            <div class="calendar-weekdays">
              <div>Sun</div>
              <div>Mon</div>
              <div>Tue</div>
              <div>Wed</div>
              <div>Thu</div>
              <div>Fri</div>
              <div>Sat</div>
            </div>
            <div class="calendar-days" id="calendarDays">
              <!-- Calendar days will be populated -->
            </div>
          </div>

          <!-- Bookings Table -->
          <div class="bookings-table-container">
            <div class="bookings-table-header">
              <h3>Booking List</h3>
              <div class="bookings-table-actions">
                <button
                  class="btn-icon"
                  title="Refresh"
                  onclick="loadBookings()"
                >
                  <i class="fas fa-sync-alt"></i>
                </button>
                <button
                  class="btn-icon"
                  title="Print"
                  onclick="printBookings()"
                >
                  <i class="fas fa-print"></i>
                </button>
                <button
                  class="btn-icon"
                  title="Export"
                  onclick="exportBookings()"
                >
                  <i class="fas fa-download"></i>
                </button>
              </div>
            </div>
            <div class="bookings-table-wrapper">
              <table class="bookings-table">
                <thead>
                  <tr>
                    <th>Client</th>
                    <th>Service</th>
                    <th>Date & Time</th>
                    <th>Price</th>
                    <th>Status</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody id="bookingsTableBody">
                  <!-- Bookings will be loaded here -->
                  <tr>
                    <td colspan="6" class="empty-state">
                      <i class="far fa-calendar-times"></i>
                      <h3>No bookings found</h3>
                      <p>Start by creating your first booking</p>
                      <button
                        class="btn btn-primary"
                        onclick="openNewBookingModal()"
                        style="margin-top: 15px"
                      >
                        <i class="fas fa-plus-circle"></i> Create Booking
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- New Booking Modal -->
    <div class="modal" id="newBookingModal">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Create New Booking</h3>
          <button class="btn-icon close-modal" onclick="closeNewBookingModal()">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="modal-body">
          <form id="newBookingForm">
            <div class="form-row">
              <div class="form-group">
                <label for="bookingClient"
                  ><i class="fas fa-user"></i> Client Name</label
                >
                <input
                  type="text"
                  id="bookingClient"
                  class="form-control"
                  placeholder="Enter client name"
                  required
                />
              </div>
              <div class="form-group">
                <label for="bookingPhone"
                  ><i class="fas fa-phone"></i> Phone Number</label
                >
                <input
                  type="tel"
                  id="bookingPhone"
                  class="form-control"
                  placeholder="Enter phone number"
                  required
                />
              </div>
            </div>
            <div class="form-group">
              <label for="bookingService"
                ><i class="fas fa-cut"></i> Service</label
              >
              <select id="bookingService" class="form-control" required>
                <option value="">Select a service</option>
                <!-- Services will be populated -->
              </select>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="bookingDate"
                  ><i class="fas fa-calendar"></i> Date</label
                >
                <input
                  type="date"
                  id="bookingDate"
                  class="form-control"
                  required
                />
              </div>
              <div class="form-group">
                <label for="bookingTime"
                  ><i class="fas fa-clock"></i> Time</label
                >
                <select id="bookingTime" class="form-control" required>
                  <option value="">Select time</option>
                  <!-- Time slots will be populated -->
                </select>
              </div>
            </div>
            <div class="form-group">
              <label for="bookingNotes"
                ><i class="fas fa-sticky-note"></i> Notes (Optional)</label
              >
              <textarea
                id="bookingNotes"
                class="form-control"
                rows="3"
                placeholder="Add any notes..."
              ></textarea>
            </div>
            <div class="form-group">
              <label for="bookingStatus"
                ><i class="fas fa-info-circle"></i> Status</label
              >
              <select id="bookingStatus" class="form-control">
                <option value="pending">Pending</option>
                <option value="confirmed" selected>Confirmed</option>
                <option value="completed">Completed</option>
              </select>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" onclick="closeNewBookingModal()">
            Cancel
          </button>
          <button class="btn btn-primary" onclick="createBooking()">
            <i class="fas fa-calendar-plus"></i> Create Booking
          </button>
        </div>
      </div>
    </div>

    <!-- Booking Details Modal -->
    <div class="modal" id="bookingDetailsModal">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Booking Details</h3>
          <button
            class="btn-icon close-modal"
            onclick="closeBookingDetailsModal()"
          >
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="modal-body">
          <div id="bookingDetailsContent">
            <!-- Details will be loaded here -->
          </div>
        </div>
        <div class="modal-footer" id="bookingDetailsActions">
          <!-- Actions will be loaded here -->
        </div>
      </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>

    <script>
      // Global variables
      let bookings = [];
      let services = [];
      let currentTab = "all";
      let currentMonth = new Date().getMonth();
      let currentYear = new Date().getFullYear();
      let selectedBooking = null;

      // Initialize bookings page
      function initBookings() {
        // Initialize date
        document.getElementById("todayDate").textContent =
          new Date().toLocaleDateString("en-US", {
            weekday: "long",
            year: "numeric",
            month: "long",
            day: "numeric",
          });

        // Load data
        loadBookings();
        loadServices();
        setupEventListeners();
        setupCalendar();
        updateStats();
      }

      function loadBookings() {
        bookings = JSON.parse(localStorage.getItem("bookings")) || [];

        // If no bookings, create sample data
        if (bookings.length === 0) {
          const today = new Date();
          const tomorrow = new Date(today);
          tomorrow.setDate(tomorrow.getDate() + 1);
          const nextWeek = new Date(today);
          nextWeek.setDate(nextWeek.getDate() + 7);

          const todayStr = today.toISOString().split("T")[0];
          const tomorrowStr = tomorrow.toISOString().split("T")[0];
          const nextWeekStr = nextWeek.toISOString().split("T")[0];

          bookings = [
            {
              id: 1,
              client: "John Doe",
              clientInitials: "JD",
              phone: "+1 (555) 123-4567",
              service: "Haircut & Beard Trim",
              date: todayStr,
              time: "10:00 AM",
              price: 8000,
              status: "confirmed",
              notes: "Regular customer, prefers fade on sides",
              createdAt: new Date().toISOString(),
            },
            {
              id: 2,
              client: "Michael Smith",
              clientInitials: "MS",
              phone: "+1 (555) 987-6543",
              service: "Beard Trim Only",
              date: todayStr,
              time: "2:30 PM",
              price: 3000,
              status: "pending",
              notes: "First time customer",
              createdAt: new Date().toISOString(),
            },
            {
              id: 3,
              client: "Robert Johnson",
              clientInitials: "RJ",
              phone: "+1 (555) 456-7890",
              service: "Full Service (Haircut, Beard, Shave)",
              date: tomorrowStr,
              time: "11:00 AM",
              price: 12000,
              status: "confirmed",
              notes: "Special occasion - wedding",
              createdAt: new Date().toISOString(),
            },
            {
              id: 4,
              client: "James Wilson",
              clientInitials: "JW",
              phone: "+1 (555) 234-5678",
              service: "Haircut",
              date: nextWeekStr,
              time: "3:00 PM",
              price: 5000,
              status: "completed",
              notes: "Completed successfully",
              createdAt: new Date().toISOString(),
            },
            {
              id: 5,
              client: "David Brown",
              clientInitials: "DB",
              phone: "+1 (555) 876-5432",
              service: "Kids Haircut",
              date: nextWeekStr,
              time: "4:30 PM",
              price: 4000,
              status: "cancelled",
              notes: "Client rescheduled",
              createdAt: new Date().toISOString(),
            },
          ];

          localStorage.setItem("bookings", JSON.stringify(bookings));
        }

        updateBookingsTable();
        updateCalendar();
        updateStats();
      }

      function loadServices() {
        const onboardingData =
          JSON.parse(localStorage.getItem("onboardingData")) || {};
        services = onboardingData.services || [];

        // Populate service dropdowns
        const serviceFilter = document.getElementById("serviceFilter");
        const bookingService = document.getElementById("bookingService");

        // Clear existing options except the first one
        while (serviceFilter.options.length > 1) serviceFilter.remove(1);
        while (bookingService.options.length > 1) bookingService.remove(1);

        services.forEach((service) => {
          const option1 = document.createElement("option");
          option1.value = service.name;
          option1.textContent = service.name;
          serviceFilter.appendChild(option1);

          const option2 = document.createElement("option");
          option2.value = service.name;
          option2.textContent = `${service.name} - ₦${service.price} (${service.duration} min)`;
          option2.dataset.price = service.price;
          option2.dataset.duration = service.duration;
          bookingService.appendChild(option2);
        });
      }

      function updateBookingsTable() {
        const tbody = document.getElementById("bookingsTableBody");
        tbody.innerHTML = "";

        let filteredBookings = [...bookings];

        // Apply tab filter
        const today = new Date().toISOString().split("T")[0];
        const tomorrow = new Date();
        tomorrow.setDate(tomorrow.getDate() + 1);
        const tomorrowStr = tomorrow.toISOString().split("T")[0];

        switch (currentTab) {
          case "today":
            filteredBookings = filteredBookings.filter((b) => b.date === today);
            break;
          case "upcoming":
            filteredBookings = filteredBookings.filter((b) => b.date > today);
            break;
          case "pending":
            filteredBookings = filteredBookings.filter(
              (b) => b.status === "pending"
            );
            break;
          case "confirmed":
            filteredBookings = filteredBookings.filter(
              (b) => b.status === "confirmed"
            );
            break;
          case "completed":
            filteredBookings = filteredBookings.filter(
              (b) => b.status === "completed"
            );
            break;
          case "cancelled":
            filteredBookings = filteredBookings.filter(
              (b) => b.status === "cancelled"
            );
            break;
        }

        // Apply other filters
        const dateFilter = document.getElementById("dateFilter").value;
        const serviceFilter = document.getElementById("serviceFilter").value;
        const statusFilter = document.getElementById("statusFilter").value;
        const sortFilter = document.getElementById("sortFilter").value;

        if (dateFilter !== "all") {
          const now = new Date();
          const startOfWeek = new Date(
            now.setDate(now.getDate() - now.getDay())
          );
          const startOfMonth = new Date(now.getFullYear(), now.getMonth(), 1);

          filteredBookings = filteredBookings.filter((booking) => {
            const bookingDate = new Date(booking.date);
            switch (dateFilter) {
              case "today":
                return booking.date === today;
              case "week":
                return bookingDate >= startOfWeek;
              case "month":
                return bookingDate >= startOfMonth;
              default:
                return true;
            }
          });
        }

        if (serviceFilter !== "all") {
          filteredBookings = filteredBookings.filter(
            (b) => b.service === serviceFilter
          );
        }

        if (statusFilter !== "all") {
          filteredBookings = filteredBookings.filter(
            (b) => b.status === statusFilter
          );
        }

        // Apply sorting
        filteredBookings.sort((a, b) => {
          switch (sortFilter) {
            case "date-asc":
              return new Date(a.date) - new Date(b.date);
            case "price-desc":
              return b.price - a.price;
            case "price-asc":
              return a.price - b.price;
            case "date-desc":
            default:
              return new Date(b.date) - new Date(a.date);
          }
        });

        if (filteredBookings.length === 0) {
          tbody.innerHTML = `
            <tr>
              <td colspan="6" class="empty-state">
                <i class="far fa-calendar-times"></i>
                <h3>No bookings found</h3>
                <p>Try changing your filters or create a new booking</p>
                <button class="btn btn-primary" onclick="openNewBookingModal()" style="margin-top: 15px;">
                  <i class="fas fa-plus-circle"></i> Create Booking
                </button>
              </td>
            </tr>
          `;
          return;
        }

        filteredBookings.forEach((booking) => {
          const row = document.createElement("tr");
          row.className = "booking-row";
          row.onclick = () => openBookingDetails(booking.id);

          const bookingDate = new Date(booking.date);
          const formattedDate = bookingDate.toLocaleDateString("en-US", {
            weekday: "short",
            month: "short",
            day: "numeric",
            year: "numeric",
          });

          row.innerHTML = `
            <td>
              <div class="booking-client">
                <div class="booking-avatar">${booking.clientInitials}</div>
                <div class="booking-client-info">
                  <h4>${booking.client}</h4>
                  <p>${booking.phone}</p>
                </div>
              </div>
            </td>
            <td class="booking-service">${booking.service}</td>
            <td>
              <div class="booking-date-time">
                <span class="booking-date">${formattedDate}</span>
                <span class="booking-time">${booking.time}</span>
              </div>
            </td>
            <td class="booking-price">₦${booking.price.toLocaleString()}</td>
            <td>
              <span class="booking-status status-${booking.status}">
                ${
                  booking.status.charAt(0).toUpperCase() +
                  booking.status.slice(1)
                }
              </span>
            </td>
            <td>
              <div class="booking-actions">
                <button class="btn-icon btn-sm" onclick="editBooking(${
                  booking.id
                }); event.stopPropagation();" title="Edit">
                  <i class="fas fa-edit"></i>
                </button>
                <button class="btn-icon btn-sm" onclick="deleteBooking(${
                  booking.id
                }); event.stopPropagation();" title="Delete">
                  <i class="fas fa-trash"></i>
                </button>
              </div>
            </td>
          `;

          tbody.appendChild(row);
        });
      }

      function updateStats() {
        const today = new Date().toISOString().split("T")[0];

        const totalBookings = bookings.length;
        const todayBookings = bookings.filter((b) => b.date === today).length;
        const confirmedBookings = bookings.filter(
          (b) => b.status === "confirmed"
        ).length;
        const totalRevenue = bookings.reduce((sum, b) => sum + b.price, 0);

        document.getElementById("totalBookings").textContent = totalBookings;
        document.getElementById("todayBookings").textContent = todayBookings;
        document.getElementById("confirmedBookings").textContent =
          confirmedBookings;
        document.getElementById("totalRevenue").textContent =
          totalRevenue.toLocaleString();
      }

      function setupCalendar() {
        updateCalendar();

        // Month navigation
        document.getElementById("prevMonth").onclick = () => {
          currentMonth--;
          if (currentMonth < 0) {
            currentMonth = 11;
            currentYear--;
          }
          updateCalendar();
        };

        document.getElementById("nextMonth").onclick = () => {
          currentMonth++;
          if (currentMonth > 11) {
            currentMonth = 0;
            currentYear++;
          }
          updateCalendar();
        };
      }

      function updateCalendar() {
        const monthNames = [
          "January",
          "February",
          "March",
          "April",
          "May",
          "June",
          "July",
          "August",
          "September",
          "October",
          "November",
          "December",
        ];

        document.getElementById(
          "calendarMonth"
        ).textContent = `${monthNames[currentMonth]} ${currentYear}`;

        const calendarDays = document.getElementById("calendarDays");
        calendarDays.innerHTML = "";

        const firstDay = new Date(currentYear, currentMonth, 1);
        const lastDay = new Date(currentYear, currentMonth + 1, 0);
        const daysInMonth = lastDay.getDate();
        const startingDay = firstDay.getDay();

        const today = new Date();
        const isTodayMonth =
          today.getMonth() === currentMonth &&
          today.getFullYear() === currentYear;

        // Empty cells for days before the first
        for (let i = 0; i < startingDay; i++) {
          const emptyDay = document.createElement("div");
          emptyDay.className = "calendar-day other-month";
          calendarDays.appendChild(emptyDay);
        }

        // Days of the month
        for (let d = 1; d <= daysInMonth; d++) {
          const dateKey = `${currentYear}-${String(currentMonth + 1).padStart(
            2,
            "0"
          )}-${String(d).padStart(2, "0")}`;
          const dayElement = document.createElement("div");
          dayElement.className = "calendar-day";

          if (isTodayMonth && d === today.getDate()) {
            dayElement.classList.add("today");
          }

          // Get bookings for this day
          const dayBookings = bookings.filter((b) => b.date === dateKey);

          dayElement.innerHTML = `
            <div class="day-number">${d}</div>
            <div class="day-bookings">
              ${dayBookings
                .slice(0, 2)
                .map(
                  (booking) => `
                <div class="day-booking booking-${booking.status}">
                  ${booking.time} - ${booking.client.split(" ")[0]}
                </div>
              `
                )
                .join("")}
              ${
                dayBookings.length > 2
                  ? `<div class="day-booking" style="background: var(--light-gray); color: var(--dark-gray);">+${
                      dayBookings.length - 2
                    } more</div>`
                  : ""
              }
            </div>
          `;

          calendarDays.appendChild(dayElement);
        }
      }

      function goToToday() {
        const today = new Date();
        currentMonth = today.getMonth();
        currentYear = today.getFullYear();
        updateCalendar();
      }

      function openNewBookingModal() {
        const modal = document.getElementById("newBookingModal");
        const dateInput = document.getElementById("bookingDate");
        const timeSelect = document.getElementById("bookingTime");

        // Set default date to today
        const today = new Date();
        dateInput.value = today.toISOString().split("T")[0];
        dateInput.min = today.toISOString().split("T")[0];

        // Clear time slots and repopulate
        timeSelect.innerHTML = '<option value="">Select time</option>';
        populateTimeSlots(dateInput.value);

        // Update time slots when date changes
        dateInput.onchange = function () {
          populateTimeSlots(this.value);
        };

        // Reset form
        document.getElementById("newBookingForm").reset();
        document.getElementById("bookingStatus").value = "confirmed";

        modal.style.display = "flex";
      }

      function populateTimeSlots(dateStr) {
        const timeSelect = document.getElementById("bookingTime");
        timeSelect.innerHTML = '<option value="">Select time</option>';

        // Check availability for the date
        const onboardingData =
          JSON.parse(localStorage.getItem("onboardingData")) || {};
        const availability = onboardingData.availability || {};
        const availableDays = new Set(availability.days || []);

        if (!availableDays.has(dateStr)) {
          timeSelect.innerHTML =
            '<option value="">Not available on this date</option>';
          timeSelect.disabled = true;
          return;
        }

        timeSelect.disabled = false;
        const startTime = availability.startTime || "09:00";
        const endTime = availability.endTime || "18:00";

        const timeSlots = [];
        const [startHour, startMinute] = startTime.split(":").map(Number);
        const [endHour, endMinute] = endTime.split(":").map(Number);

        let currentHour = startHour;
        let currentMinute = startMinute;

        while (
          currentHour < endHour ||
          (currentHour === endHour && currentMinute < endMinute)
        ) {
          const timeString = `${String(currentHour).padStart(2, "0")}:${String(
            currentMinute
          ).padStart(2, "0")}`;
          const displayTime = formatTime(timeString);

          const isBooked = bookings.some(
            (b) => b.date === dateStr && b.time.includes(timeString)
          );

          if (!isBooked) {
            timeSlots.push({ value: timeString, display: displayTime });
          }

          currentMinute += 30;
          if (currentMinute >= 60) {
            currentHour++;
            currentMinute -= 60;
          }
        }

        timeSlots.forEach((slot) => {
          const option = document.createElement("option");
          option.value = slot.value;
          option.textContent = slot.display;
          timeSelect.appendChild(option);
        });

        if (timeSlots.length === 0) {
          timeSelect.innerHTML = '<option value="">No available slots</option>';
          timeSelect.disabled = true;
        }
      }

      function formatTime(timeString) {
        const [hours, minutes] = timeString.split(":");
        const hour = parseInt(hours);
        const ampm = hour >= 12 ? "PM" : "AM";
        const formattedHour = hour % 12 || 12;
        return `${formattedHour}:${minutes} ${ampm}`;
      }

      function createBooking() {
        const client = document.getElementById("bookingClient").value.trim();
        const phone = document.getElementById("bookingPhone").value.trim();
        const service = document.getElementById("bookingService").value;
        const date = document.getElementById("bookingDate").value;
        const time = document.getElementById("bookingTime").value;
        const notes = document.getElementById("bookingNotes").value.trim();
        const status = document.getElementById("bookingStatus").value;

        if (!client || !phone || !service || !date || !time) {
          showToast("Please fill in all required fields", "error");
          return;
        }

        // Get service price
        const selectedService = services.find((s) => s.name === service);
        const price = selectedService ? selectedService.price : 5000;

        const newId =
          bookings.length > 0 ? Math.max(...bookings.map((b) => b.id)) + 1 : 1;
        const newBooking = {
          id: newId,
          client: client,
          clientInitials: client
            .split(" ")
            .map((n) => n[0])
            .join("")
            .toUpperCase()
            .substring(0, 2),
          phone: phone,
          service: service,
          date: date,
          time: formatTime(time),
          price: price,
          status: status,
          notes: notes,
          createdAt: new Date().toISOString(),
        };

        bookings.push(newBooking);
        localStorage.setItem("bookings", JSON.stringify(bookings));

        closeNewBookingModal();
        loadBookings();
        updateStats();
        updateCalendar();

        showToast(`Booking created for ${client}`, "success");
      }

      function closeNewBookingModal() {
        document.getElementById("newBookingModal").style.display = "none";
      }

      function openBookingDetails(bookingId) {
        selectedBooking = bookings.find((b) => b.id === bookingId);
        if (!selectedBooking) return;

        const modal = document.getElementById("bookingDetailsModal");
        const content = document.getElementById("bookingDetailsContent");
        const actions = document.getElementById("bookingDetailsActions");

        const bookingDate = new Date(selectedBooking.date);
        const formattedDate = bookingDate.toLocaleDateString("en-US", {
          weekday: "long",
          year: "numeric",
          month: "long",
          day: "numeric",
        });

        content.innerHTML = `
          <div style="margin-bottom: 24px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
              <h3 style="margin: 0; font-size: 1.4rem;">${
                selectedBooking.client
              }</h3>
              <span class="booking-status status-${
                selectedBooking.status
              }" style="padding: 8px 16px; font-size: 0.9rem;">
                ${
                  selectedBooking.status.charAt(0).toUpperCase() +
                  selectedBooking.status.slice(1)
                }
              </span>
            </div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 24px;">
              <div>
                <div style="font-size: 0.9rem; color: var(--gray); margin-bottom: 4px;">Phone Number</div>
                <div style="font-weight: 600; font-size: 1.1rem;">${
                  selectedBooking.phone
                }</div>
              </div>
              <div>
                <div style="font-size: 0.9rem; color: var(--gray); margin-bottom: 4px;">Service</div>
                <div style="font-weight: 600; font-size: 1.1rem;">${
                  selectedBooking.service
                }</div>
              </div>
              <div>
                <div style="font-size: 0.9rem; color: var(--gray); margin-bottom: 4px;">Date</div>
                <div style="font-weight: 600; font-size: 1.1rem;">${formattedDate}</div>
              </div>
              <div>
                <div style="font-size: 0.9rem; color: var(--gray); margin-bottom: 4px;">Time</div>
                <div style="font-weight: 600; font-size: 1.1rem;">${
                  selectedBooking.time
                }</div>
              </div>
            </div>
            
            <div style="margin-bottom: 24px;">
              <div style="font-size: 0.9rem; color: var(--gray); margin-bottom: 4px;">Price</div>
              <div style="font-weight: 700; font-size: 1.8rem; color: var(--secondary);">₦${selectedBooking.price.toLocaleString()}</div>
            </div>
            
            ${
              selectedBooking.notes
                ? `
              <div>
                <div style="font-size: 0.9rem; color: var(--gray); margin-bottom: 8px;">Notes</div>
                <div style="background: var(--light-gray); padding: 16px; border-radius: var(--radius);">
                  ${selectedBooking.notes}
                </div>
              </div>
            `
                : ""
            }
          </div>
        `;

        // Set up actions based on status
        actions.innerHTML = "";

        if (selectedBooking.status === "pending") {
          actions.innerHTML = `
            <button class="btn btn-success" onclick="updateBookingStatus('confirmed')">
              <i class="fas fa-check-circle"></i> Confirm
            </button>
            <button class="btn btn-danger" onclick="updateBookingStatus('cancelled')">
              <i class="fas fa-times-circle"></i> Cancel
            </button>
            <button class="btn btn-secondary" onclick="closeBookingDetailsModal()">
              Close
            </button>
          `;
        } else if (selectedBooking.status === "confirmed") {
          actions.innerHTML = `
            <button class="btn btn-success" onclick="updateBookingStatus('completed')">
              <i class="fas fa-check-double"></i> Mark as Completed
            </button>
            <button class="btn btn-warning" onclick="editBooking(${selectedBooking.id})">
              <i class="fas fa-edit"></i> Edit
            </button>
            <button class="btn btn-secondary" onclick="closeBookingDetailsModal()">
              Close
            </button>
          `;
        } else {
          actions.innerHTML = `
            <button class="btn btn-secondary" onclick="closeBookingDetailsModal()">
              Close
            </button>
          `;
        }

        modal.style.display = "flex";
      }

      function closeBookingDetailsModal() {
        document.getElementById("bookingDetailsModal").style.display = "none";
        selectedBooking = null;
      }

      function editBooking(bookingId) {
        const booking = bookings.find((b) => b.id === bookingId);
        if (!booking) return;

        // For now, just open the booking details
        // In a real app, this would open an edit form
        openBookingDetails(bookingId);
        showToast("Edit feature coming soon", "info");
      }

      function deleteBooking(bookingId) {
        if (confirm("Are you sure you want to delete this booking?")) {
          bookings = bookings.filter((b) => b.id !== bookingId);
          localStorage.setItem("bookings", JSON.stringify(bookings));
          loadBookings();
          updateStats();
          updateCalendar();
          showToast("Booking deleted", "warning");
        }
      }

      function updateBookingStatus(newStatus) {
        if (!selectedBooking) return;

        selectedBooking.status = newStatus;
        localStorage.setItem("bookings", JSON.stringify(bookings));

        closeBookingDetailsModal();
        loadBookings();
        updateStats();
        updateCalendar();

        showToast(`Booking marked as ${newStatus}`, "success");
      }

      function clearFilters() {
        document.getElementById("dateFilter").value = "all";
        document.getElementById("serviceFilter").value = "all";
        document.getElementById("statusFilter").value = "all";
        document.getElementById("sortFilter").value = "date-desc";
        updateBookingsTable();
      }

      function printBookings() {
        showToast("Print feature coming soon", "info");
      }

      function exportBookings() {
        showToast("Export feature coming soon", "info");
      }

      function setupEventListeners() {
        // Sidebar toggle
        const sidebar = document.getElementById("sidebar");
        const hamburgerBtn = document.getElementById("hamburger-btn");
        const overlay = document.getElementById("mobile-overlay");

        if (hamburgerBtn) {
          hamburgerBtn.addEventListener("click", toggleSidebar);
        }

        if (overlay) {
          overlay.addEventListener("click", () => {
            sidebar.classList.remove("mobile-open");
            overlay.style.opacity = "0";
            setTimeout(() => (overlay.style.display = "none"), 300);
          });
        }

        // Add click event to sidebar toggle icon
        const toggleIcon = document.querySelector(".sidebar-toggle-icon");
        if (toggleIcon) {
          toggleIcon.addEventListener("click", toggleSidebar);
        }

        // Tab switching
        document.querySelectorAll(".booking-tab").forEach((tab) => {
          tab.addEventListener("click", () => {
            document
              .querySelectorAll(".booking-tab")
              .forEach((t) => t.classList.remove("active"));
            tab.classList.add("active");
            currentTab = tab.getAttribute("data-tab");
            updateBookingsTable();
          });
        });

        // Filter changes
        document
          .getElementById("dateFilter")
          .addEventListener("change", updateBookingsTable);
        document
          .getElementById("serviceFilter")
          .addEventListener("change", updateBookingsTable);
        document
          .getElementById("statusFilter")
          .addEventListener("change", updateBookingsTable);
        document
          .getElementById("sortFilter")
          .addEventListener("change", updateBookingsTable);

        // Window resize
        window.addEventListener("resize", () => {
          if (window.innerWidth > 1024) {
            sidebar.classList.remove("mobile-open");
            if (overlay) {
              overlay.style.display = "none";
              overlay.style.opacity = "0";
            }
          }
        });

        // Modal close on outside click
        window.addEventListener("click", (event) => {
          const modals = ["newBookingModal", "bookingDetailsModal"];
          modals.forEach((modalId) => {
            const modal = document.getElementById(modalId);
            if (event.target === modal) {
              if (modalId === "newBookingModal") closeNewBookingModal();
              if (modalId === "bookingDetailsModal") closeBookingDetailsModal();
            }
          });
        });
      }

      function toggleSidebar() {
        const sidebar = document.getElementById("sidebar");
        const overlay = document.getElementById("mobile-overlay");
        const isMobile = window.innerWidth <= 1024;

        if (isMobile) {
          sidebar.classList.toggle("mobile-open");
          if (sidebar.classList.contains("mobile-open")) {
            if (overlay) {
              overlay.style.display = "block";
              setTimeout(() => (overlay.style.opacity = "1"), 10);
            }
          } else {
            if (overlay) {
              overlay.style.opacity = "0";
              setTimeout(() => (overlay.style.display = "none"), 300);
            }
          }
        } else {
          sidebar.classList.toggle("collapsed");
        }
      }

      function showToast(message, type = "info") {
        const toast = document.getElementById("toast");
        toast.textContent = message;
        toast.className = `toast ${type}`;

        let icon = "fas fa-info-circle";
        if (type === "success") icon = "fas fa-check-circle";
        if (type === "error") icon = "fas fa-exclamation-circle";
        if (type === "warning") icon = "fas fa-exclamation-triangle";

        toast.innerHTML = `<i class="${icon}"></i> ${message}`;

        setTimeout(() => toast.classList.add("show"), 10);
        setTimeout(() => toast.classList.remove("show"), 3000);
      }

      // Initialize when page loads
      document.addEventListener("DOMContentLoaded", initBookings);

      // Quick fix for sidebar
      document.addEventListener("DOMContentLoaded", function () {
        // Initialize sidebar
        const sidebar = document.getElementById("sidebar");
        const hamburgerBtn = document.getElementById("hamburger-btn");
        const overlay = document.getElementById("mobile-overlay");
        const toggleIcon = document.querySelector(".sidebar-toggle-icon");

        // Toggle sidebar when hamburger button is clicked
        if (hamburgerBtn) {
          hamburgerBtn.addEventListener("click", function () {
            toggleSidebar();
          });
        }

        // Toggle sidebar when sidebar toggle icon is clicked
        if (toggleIcon) {
          toggleIcon.addEventListener("click", function () {
            toggleSidebar();
          });
        }

        // Close sidebar when overlay is clicked
        if (overlay) {
          overlay.addEventListener("click", function () {
            closeSidebar();
          });
        }

        // Window resize handler
        window.addEventListener("resize", function () {
          if (window.innerWidth > 1024) {
            closeSidebar();
          }
        });

        function toggleSidebar() {
          if (window.innerWidth <= 1024) {
            sidebar.classList.toggle("mobile-open");
            if (sidebar.classList.contains("mobile-open")) {
              overlay.style.display = "block";
              setTimeout(() => (overlay.style.opacity = "1"), 10);
            } else {
              closeSidebar();
            }
          } else {
            // Desktop: toggle collapsed state
            sidebar.classList.toggle("collapsed");
          }
        }

        function closeSidebar() {
          sidebar.classList.remove("mobile-open");
          overlay.style.opacity = "0";
          setTimeout(() => (overlay.style.display = "none"), 300);
        }

        // Initialize the rest of the page
        initBookings();
      });
    </script>
  </body>
</html>
